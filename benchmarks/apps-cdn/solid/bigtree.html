<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Solid CDN - Big Tree</title>
  <style>
    body { font-family: system-ui; max-width: 960px; margin: 0 auto; padding: 24px; }
    section { margin-bottom: 24px; }
    .grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 16px; }
    .card { border: 1px solid #ddd; border-radius: 8px; padding: 12px; }
    ul, ol { padding-left: 20px; }
    button { margin-right: 8px; }
    .static-grid { display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 8px; }
    .static-cell { border: 1px dashed #ccc; padding: 6px; border-radius: 6px; font-size: 12px; }
  </style>
</head>
<body>
  <div id="app"></div>
  <script type="module">
    import { createSignal, For } from "https://esm.sh/solid-js@1.9.3";
    import { render } from "https://esm.sh/solid-js@1.9.3/web";
    import html from "https://esm.sh/solid-js@1.9.3/html";

    const createTodo = (index) => ({ id: `todo-${index}`, text: `Todo ${index}` });
    const createListItem = () => ({
      id: `item-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,
      message: "Hello, World!"
    });

    function App() {
      const [count, setCount] = createSignal(0);
      const [todos, setTodos] = createSignal(Array.from({ length: 100 }, (_, i) => createTodo(i)));
      const [items, setItems] = createSignal(Array.from({ length: 50 }, () => createListItem()));

      const refreshList = () => {
        const next = items().map((item) => ({
          ...item,
          message: item.message.replace(" (UPDATED!)", "")
        }));
        next.unshift(createListItem());
        if (next.length > 5 && next[1]) {
          next[1].message += " (UPDATED!)";
        }
        setItems(next);
      };

      const staticCells = Array.from({ length: 200 }, (_, i) => i);

      return html`<div>
        <h1>Solid Big Tree Workload</h1>
        <p>Localized signals with keyed list updates.</p>
        <div class="grid">
          <section class="card">
            <h3>Counter</h3>
            <h2>Count: ${count}</h2>
            <button type="button" onClick=${() => setCount((n) => n + 1)}>+1</button>
          </section>
          <section class="card">
            <h3>Todos</h3>
            <ul>
              <${For} each=${todos()}>
                ${(todo) => html`<li>${todo.text}</li>`}
              </${For}>
            </ul>
            <button type="button" onClick=${() => setTodos((prev) => [...prev, createTodo(prev.length)])}>
              Add Todo
            </button>
          </section>
          <section class="card">
            <h3>Ordered List Keyed</h3>
            <ol>
              <${For} each=${items()}>
                ${(item) => html`<li>${item.message}</li>`}
              </${For}>
            </ol>
            <button type="button" onClick=${refreshList}>Refresh List</button>
          </section>
          <section class="card">
            <h3>Static Tree (200 nodes)</h3>
            <div class="static-grid">
              <${For} each=${staticCells}>
                ${(i) => html`<div class="static-cell">Static ${i + 1}</div>`}
              </${For}>
            </div>
          </section>
        </div>
      </div>`;
    }

    render(App, document.getElementById("app"));
  </script>
</body>
</html>
